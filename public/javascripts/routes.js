// Generated by CoffeeScript 1.6.3
(function() {
  var drawWeapons, getMechClass;

  drawWeapons = function() {
    return WEAPONS.forEach(function(weapon) {
      return $('.weapons .' + weapon.type).append(Templates.weapon(weapon));
    });
  };

  window.drawMech = function() {
    var context, part, part_info, _results;
    $('.parts').empty().show();
    _results = [];
    for (part in PARTS) {
      part_info = PARTS[part];
      context = {
        name: part,
        armor: active_mech['ARMOR_' + part],
        structure: active_mech['STRUCTURE_' + part],
        armor_remaining: active_mech['armor_' + part],
        structure_remaining: active_mech['structure_' + part]
      };
      _results.push($('.parts').append(Templates.part(context)));
    }
    return _results;
  };

  bone.set('log', false);

  bone.set('templates', Templates);

  drawWeapons();

  window.active_player = null;

  window.active_mech = null;

  window.router = bone.router({
    routes: {
      '': 'root',
      ':player': 'player',
      ':player/:mech': 'mech'
    },
    root: function() {
      window.active_player = null;
      return bone.mount('.players', 'players', {
        data: players,
        refresh: true
      });
    },
    player: function(player_name) {
      window.active_player = _.findWhere(players, {
        name: player_name
      });
      bone.mount('.players', 'players', {
        data: active_player.name
      });
      bone.mount('.mechs', 'mechs', {
        data: active_player.mechs
      });
      return $('.parts').hide();
    },
    mech: function(player_name, mech_name) {
      var MechClass;
      this.player(player_name);
      window.active_mech = _.findWhere(active_player.mechs, {
        name: mech_name
      });
      MechClass = getMechClass(window.active_mech.type);
      window.active_mech = new MechClass(active_mech);
      return drawMech();
    }
  });

  getMechClass = function(type) {
    return _.find(MECHS, function(MECH) {
      return MECH.prototype.NAME === type;
    });
  };

  bone.router.start();

}).call(this);
